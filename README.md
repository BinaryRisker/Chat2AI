# Chat2AI
è·¨å¹³å°AIèŠå¤©å·¥å…·ï¼Œæ”¯æŒå¤šç§å¤§æ¨¡å‹ã€‚ç›®å‰é¡¹ç›®å·²å®Œæˆå¤§è§„æ¨¡é‡æ„ï¼Œå®ç°äº†å‰åç«¯åˆ†ç¦»çš„ç°ä»£åŒ–æ¶æ„ï¼Œå¹¶æ‰“é€šäº†çœŸå®æ•°æ®é“¾è·¯ã€‚

## é¡¹ç›®æ¦‚è¿°
ä¸€ä¸ªè·¨å¹³å°çš„AIèŠå¤©UIå·¥å…·ï¼ŒåŒ…å«å‰åç«¯å®Œæ•´å®ç°ï¼š
- **å‰ç«¯**: Flutterå®ç°ï¼Œé‡‡ç”¨åˆ†æ å¼å¸ƒå±€ï¼Œæ”¯æŒiOS/Android/Web/æ¡Œé¢ç«¯ã€‚
- **åç«¯**: Node.js + Express + Sequelize å®ç°ï¼Œæä¾›APIæœåŠ¡ï¼Œä½¿ç”¨SQLiteæ•°æ®åº“ã€‚
- **æ ¸å¿ƒåŠŸèƒ½**:
  - âœ… çœŸå®ç”¨æˆ·æ³¨å†Œä¸ç™»å½• (JWTè®¤è¯)
  - âœ… çœŸå®ä¼šè¯åˆ—è¡¨è·å–ä¸å±•ç¤º
  - âœ… çœŸå®åˆ›å»ºä¼šè¯ä¸å‘é€æ¶ˆæ¯ (åç«¯ç®€å•åº”ç­”)
  - ğŸš§ (å¾…åŠ) å¯¹æ¥çœŸå®AIå¤§æ¨¡å‹
  - ğŸš§ (å¾…åŠ) å®Œå–„æ¨¡å‹é…ç½®ä¸UIç»†èŠ‚

## åŠŸèƒ½éœ€æ±‚

### æ ¸å¿ƒåŠŸèƒ½
1. **å¤šAIæ¨¡å‹æ”¯æŒ**
   - å¯é…ç½®æ¥å…¥OpenAIã€Claudeã€Geminiç­‰ä¸»æµå¤§æ¨¡å‹
   - æ”¯æŒè‡ªå®šä¹‰APIç«¯ç‚¹
   - æ¨¡å‹å‚æ•°å¯è°ƒèŠ‚ï¼ˆæ¸©åº¦ã€top_pç­‰ï¼‰

2. **ç”¨æˆ·ç³»ç»Ÿ**
   - é‚®ç®±/æ‰‹æœºå·æ³¨å†Œç™»å½•
   - JWTèº«ä»½éªŒè¯
   - ç”¨æˆ·åå¥½è®¾ç½®å­˜å‚¨

3. **èŠå¤©åŠŸèƒ½**
   - å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
   - æ¶ˆæ¯æ ‡è®°/æ”¶è—
   - å¯¹è¯å¯¼å‡ºåŠŸèƒ½

4. **å†å²è®°å½•**
   - æœ¬åœ°å­˜å‚¨èŠå¤©è®°å½•
   - äº‘ç«¯åŒæ­¥ï¼ˆå¯é€‰ï¼‰
   - æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½

### æŠ€æœ¯æ¶æ„

#### å‰ç«¯æ¶æ„ (Flutter)
```
lib/
â”œâ”€â”€ models/                # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ chat_model.dart    # èŠå¤©æ¶ˆæ¯æ¨¡å‹
â”‚   â”œâ”€â”€ user_model.dart   # ç”¨æˆ·æ¨¡å‹
â”‚   â””â”€â”€ settings_model.dart # è®¾ç½®æ¨¡å‹
â”œâ”€â”€ services/              # APIæœåŠ¡
â”‚   â”œâ”€â”€ api_service.dart   # åŸºç¡€APIæœåŠ¡
â”‚   â”œâ”€â”€ chat_service.dart # èŠå¤©æœåŠ¡
â”‚   â”œâ”€â”€ settings_service.dart
â”‚   â””â”€â”€ user_service.dart
â”œâ”€â”€ stores/                # çŠ¶æ€ç®¡ç† (Riverpod)
â”‚   â”œâ”€â”€ chat_store.dart    # èŠå¤©çŠ¶æ€
â”‚   â”œâ”€â”€ user_store.dart    # ç”¨æˆ·çŠ¶æ€
â”‚   â””â”€â”€ theme_store.dart   # ä¸»é¢˜çŠ¶æ€
â”œâ”€â”€ pages/                 # é¡µé¢
â”‚   â”œâ”€â”€ chat_page.dart     # èŠå¤©é¡µé¢
â”‚   â”œâ”€â”€ home_page.dart     # ä¸»é¡µ
â”‚   â”œâ”€â”€ login_page.dart    # ç™»å½•é¡µ
â”‚   â”œâ”€â”€ register_page.dart # æ³¨å†Œé¡µ
â”‚   â””â”€â”€ settings_page.dart # è®¾ç½®é¡µ
â”œâ”€â”€ widgets/               # ç»„ä»¶
â”‚   â”œâ”€â”€ chat_input.dart    # èŠå¤©è¾“å…¥æ¡†
â”‚   â”œâ”€â”€ conversation_list.dart # ä¼šè¯åˆ—è¡¨
â”‚   â”œâ”€â”€ message_bubble.dart # æ¶ˆæ¯æ°”æ³¡
â”‚   â”œâ”€â”€ new_chat_button.dart # æ–°å»ºèŠå¤©æŒ‰é’®
â”‚   â””â”€â”€ settings_tile.dart # è®¾ç½®é¡¹
â”œâ”€â”€ app.dart               # åº”ç”¨å…¥å£
â”œâ”€â”€ config.dart            # é…ç½®
â”œâ”€â”€ main.dart              # ä¸»æ–‡ä»¶
â”œâ”€â”€ routes.dart            # è·¯ç”±é…ç½®
â””â”€â”€ themes.dart            # ä¸»é¢˜é…ç½®
```

#### åç«¯æ¶æ„ (Node.js - å½“å‰çŠ¶æ€)
```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ auth.js       # è®¤è¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ chat.js       # èŠå¤©æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ users.js      # ç”¨æˆ·æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/       # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.js       # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ tracing.js    # è¿½è¸ªä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ validation.js # éªŒè¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ conversation.js # ä¼šè¯æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ message.js    # æ¶ˆæ¯æ¨¡å‹
â”‚   â”‚   â””â”€â”€ user.js       # ç”¨æˆ·æ¨¡å‹
â”‚   â”œâ”€â”€ routes/           # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.js       # è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ chat.js       # èŠå¤©è·¯ç”±
â”‚   â”‚   â””â”€â”€ users.js      # ç”¨æˆ·è·¯ç”±
â”‚   â”œâ”€â”€ services/        # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ ai/          # AIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ chat.service.js # èŠå¤©æœåŠ¡
â”‚   â”‚   â””â”€â”€ search.service.js # æœç´¢æœåŠ¡
â”‚   â”œâ”€â”€ tests/           # æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ __mocks__/   # æ¨¡æ‹Ÿæ•°æ®
â”‚   â”‚   â”œâ”€â”€ ai.service.test.js
â”‚   â”‚   â”œâ”€â”€ chat.service.test.js
â”‚   â”‚   â””â”€â”€ search.service.test.js
â”‚   â”œâ”€â”€ utils/           # å·¥å…·ç±»
â”‚   â”‚   â””â”€â”€ trace.js     # è¿½è¸ªå·¥å…·
â”‚   â”œâ”€â”€ validation/      # éªŒè¯é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ auth.js     # è®¤è¯éªŒè¯
â”‚   â”‚   â”œâ”€â”€ chat.js     # èŠå¤©éªŒè¯
â”‚   â”‚   â””â”€â”€ users.js    # ç”¨æˆ·éªŒè¯
â”‚   â”œâ”€â”€ app.js          # Expressåº”ç”¨ä¸»æ–‡ä»¶
â”‚   â”œâ”€â”€ config.js       # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ db.js          # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ index.js       # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ package.json  # é¡¹ç›®ä¾èµ–
â””â”€â”€ tests/             # æµ‹è¯•
    â”œâ”€â”€ __mocks__/    # æ¨¡æ‹Ÿæ•°æ®
    â”œâ”€â”€ ai.service.test.js
    â”œâ”€â”€ chat.service.test.js
    â””â”€â”€ search.service.test.js
```

## æŠ€æœ¯é€‰å‹ (å½“å‰å®ç°)

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Flutter 3.x
- **çŠ¶æ€ç®¡ç†**: Riverpod (`flutter_riverpod`)
- **UIç»„ä»¶**: Material Design
- **ç½‘ç»œè¯·æ±‚**: `dio` åŒ…

### åç«¯æŠ€æœ¯æ ˆ
- **è¿è¡Œæ—¶**: Node.js 18+
- **æ¡†æ¶**: Express.js
- **æ•°æ®åº“äº¤äº’**: Sequelize (å¤šæ–¹è¨€ ORM)
- **è®¤è¯**: JWT (`jsonwebtoken`)
- **å¯†ç å“ˆå¸Œ**: `bcrypt`
- **éªŒè¯**: `express-validator`
- **ä¸»è¦ä¾èµ–**: `cors`, `helmet`, `morgan`

### æ•°æ®åº“
- **å½“å‰ä½¿ç”¨**: SQLite (é€šè¿‡ `better-sqlite3` é©±åŠ¨)

### DevOps
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **CI/CD**: GitHub Actions
- **ç›‘æ§**: Prometheus + Grafana (å¯é€‰)

## åç»­è®¡åˆ’ (Next Steps)

å½“å‰é¡¹ç›®çš„åŸºç¡€æ¶æ„å’Œæ ¸å¿ƒæ•°æ®é“¾è·¯å·²ç»æ­å»ºå®Œæˆã€‚æ¥ä¸‹æ¥çš„å¼€å‘é‡ç‚¹æ˜¯å®ç°æ ¸å¿ƒçš„AIåŠŸèƒ½å¹¶ä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚

### 1. å¯¹æ¥çœŸå®AIå¤§æ¨¡å‹
- **ä»»åŠ¡**: ä¿®æ”¹åç«¯æœåŠ¡ï¼Œå°†å½“å‰çš„æ¶ˆæ¯ç®€å•åº”ç­”é€»è¾‘æ›¿æ¢ä¸ºå¯¹çœŸå®AIæ¨¡å‹ï¼ˆå¦‚OpenAI, Geminiç­‰ï¼‰çš„APIè°ƒç”¨ã€‚
- **æ­¥éª¤**:
  - åœ¨åç«¯ `config.js` ä¸­æ·»åŠ API Keyé…ç½®ã€‚
  - åˆ›å»ºä¸€ä¸ª `AIService`ï¼Œç”¨äºå°è£…å¯¹ä¸åŒå¤§æ¨¡å‹APIçš„è°ƒç”¨ã€‚
  - åœ¨ `chat.controller.js` ä¸­è°ƒç”¨ `AIService` è·å–æ¨¡å‹å›å¤ã€‚

### 2. å®Œå–„å‰ç«¯UIä¸çŠ¶æ€ç®¡ç†
- **ä»»åŠ¡**: è®©å‰ç«¯çš„UIç»„ä»¶ï¼ˆå¦‚æ¨¡å‹é€‰æ‹©ã€è®¾ç½®ç­‰ï¼‰ä¸çŠ¶æ€å’Œåç«¯çœŸå®äº¤äº’ã€‚
- **æ­¥éª¤**:
  - åœ¨ `chat_store.dart` ä¸­æ·»åŠ ç®¡ç†å½“å‰AIæ¨¡å‹ã€æ¸©åº¦ç­‰å‚æ•°çš„çŠ¶æ€ã€‚
  - å®ç° `ChatPage` é¡¶éƒ¨çš„æ¨¡å‹ä¸‹æ‹‰èœå•ï¼Œä½¿å…¶èƒ½åŠ¨æ€æ”¹å˜ `chat_store` ä¸­çš„æ¨¡å‹çŠ¶æ€ã€‚
  - æ¢å¤å¹¶å®Œå–„ `SettingsPage` çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸»é¢˜åˆ‡æ¢ã€‚

### 3. é”™è¯¯å¤„ç†ä¸ç”¨æˆ·åé¦ˆ
- **ä»»åŠ¡**: åœ¨å‰åç«¯å¢åŠ å…¨é¢çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚
- **æ­¥éª¤**:
  - åœ¨åç«¯APIä¸­ï¼Œä¸ºæ— æ•ˆè¯·æ±‚ã€æ•°æ®åº“é”™è¯¯ç­‰å¢åŠ ç»Ÿä¸€çš„é”™è¯¯å“åº”ã€‚
  - åœ¨å‰ç«¯ `ApiService` ä¸­ï¼Œä½¿ç”¨ `try-catch` æ•è·Dioå¼‚å¸¸ã€‚
  - åœ¨UIå±‚ï¼Œé€šè¿‡ `AsyncValue` çš„ `error` çŠ¶æ€æˆ– `Snackbar` å‘ç”¨æˆ·å±•ç¤ºæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯ã€‚

### 4. ä»£ç æ¸…ç†ä¸ä¼˜åŒ–
- **ä»»åŠ¡**: ç§»é™¤é¡¹ç›®ä¸­ä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆå’Œæ¨¡æ‹Ÿæ•°æ®ã€‚
- **æ­¥éª¤**:
  - å°†åœ¨ `chat_store.dart` ä¸­ä¸´æ—¶å®šä¹‰çš„ `Message` å’Œ `Conversation` æ¨¡å‹ç§»åŠ¨åˆ°ç‹¬ç«‹çš„ `models` æ–‡ä»¶ä¸­ã€‚
  - ç§»é™¤æ‰€æœ‰å‰©ä½™çš„æ¨¡æ‹Ÿæ•°æ®å’Œ `print` è¯­å¥ã€‚

## ç¯å¢ƒè¦æ±‚

### å¼€å‘ç¯å¢ƒ
- Flutter SDK 3.0+
- Node.js 18+
- Android Studio/Xcode (ç§»åŠ¨ç«¯å¼€å‘)
- VS Code (æ¨èIDE)

### ç”Ÿäº§ç¯å¢ƒ
- LinuxæœåŠ¡å™¨ (æ¨èUbuntu 22.04)
- Docker Engine 20.10+
- PostgreSQL 14+
- Nginx (åå‘ä»£ç†)

### æœ¬åœ°å¼€å‘æŒ‡å—

#### ç¯å¢ƒå‡†å¤‡
1. å®‰è£…Node.js 18+å’ŒFlutter 3.0+
2. (å¯é€‰) å®‰è£…VS Codeç­‰IDE
3. **å‰ç«¯é…ç½®**: ä¿®æ”¹ `lib/config.dart` æ–‡ä»¶ä¸­çš„ `baseUrl`ï¼Œä½¿å…¶æŒ‡å‘ä½ çš„åç«¯æœåŠ¡å™¨åœ°å€ã€‚

### å¯åŠ¨åç«¯æœåŠ¡
```bash
cd server
npm install
npm run dev
```

### å¯åŠ¨å‰ç«¯åº”ç”¨
```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
flutter pub get
flutter run
```

### è¿è¡Œåç«¯æµ‹è¯•
``````bash
cd server
npm install
npm test
```

### è¿è¡Œåç«¯æµ‹è¯•
```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
flutter pub get
flutter test
```